run:
  timeout: 5m

linters:
  enable:
    - gocritic
    - revive
    - nestif
    - ruleguard
    - gocognit
    - maintidx
    - funlen
  disable:
    - gocyclo

linters-settings:
  # Alarmas (no refactor hints directos, pero útiles)
  gocognit:
    min-complexity: 10

  maintidx:
    # Flaggea funciones con MI < under (más bajo = peor mantenibilidad)
    under: 20

  # Smells concretos
  nestif:
    min-complexity: 4

  funlen:
    lines: 80
    statements: 40

  # go-critic settings (algunos ejemplos de thresholds configurables)
  gocritic:
    settings:
      ifElseChain:
        minThreshold: 4
      nestingReduce:
        bodyWidth: 4

  # ruleguard como linter propio de golangci-lint
  ruleguard:
    rules: "${config-path}/ruleguard/rules-*.go"
    failOn: "dsl,import"
    enable: "smells"

issues:
  # Para que el gate sea más “PR-friendly”:
  max-issues-per-linter: 0
  max-same-issues: 0
  # Exclude generated code (aligned with Makefile coverage-gate exclusions, lines 104-107)
  exclude-dirs:
    - internal/infra/sqlite/sqlcgen  # sqlc generated code
    - vendor
  exclude-files:
    - ".*\\.pb\\.go$"  # Future protobuf generated files
    - ".*_test\\.go$"  # Test files (allowed to be complex, caught by gocyclo instead)
